<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="title">مخطط وجبات أسبوعي مجاني – قائمة التسوق و PDF مجاناً</title>
  <meta name="description" content="أنشئ خطة وجباتك للأسبوع، احصل على قائمة التسوق الخاصة بك وقم بتنزيلها بصيغة PDF مجاناً، كل ذلك عبر الإنترنت وباللغة العربية.">
  <meta name="keywords" content="مخطط وجبات أسبوعي, قائمة تسوق, خطة وجبات, منظم قائمة الطعام, قائمة تسوق pdf, تخطيط الوجبات, وجبات عائلية, وجبات صحية, meal planner arabic" />
  <link rel="canonical" href="https://meal-planner.ro/ar/" />

  <!-- hreflang pentru toate limbile -->
  <link rel="alternate" hreflang="x-default" href="https://meal-planner.ro/" />
  <link rel="alternate" hreflang="ro" href="https://meal-planner.ro/ro/" />
  <link rel="alternate" hreflang="en" href="https://meal-planner.ro/en/" />
  <link rel="alternate" hreflang="es" href="https://meal-planner.ro/es/" />
  <link rel="alternate" hreflang="fr" href="https://meal-planner.ro/fr/" />
  <link rel="alternate" hreflang="ru" href="https://meal-planner.ro/ru/" />
  <link rel="alternate" hreflang="zh" href="https://meal-planner.ro/zh/" />
  <link rel="alternate" hreflang="ja" href="https://meal-planner.ro/ja/" />
  <link rel="alternate" hreflang="pt" href="https://meal-planner.ro/pt/" />
  <link rel="alternate" hreflang="de" href="https://meal-planner.ro/de/" />
  <link rel="alternate" hreflang="ar" href="https://meal-planner.ro/ar/" />
  <link rel="alternate" hreflang="hi" href="https://meal-planner.ro/hi/" />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="مخطط وجبات أسبوعي مجاني" />
  <meta property="og:description" content="أنشئ خطة وجبات للأسبوع، احصل على قائمة التسوق وحمّلها PDF مجاناً." />
  <meta property="og:url" content="https://meal-planner.ro/ar/" />
  <meta property="og:image" content="https://meal-planner.ro/cover.jpg" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="مخطط وجبات أسبوعي مجاني" />
  <meta name="twitter:description" content="أنشئ خطة وجبات الأسبوع وحمّلها PDF مجاناً." />
  <meta name="twitter:url" content="https://meal-planner.ro/ar/" />

  <link rel="icon" type="image/png" href="/favicon.png" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="/css/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
</head>
<body>
  <div class="container py-5" id="pdf-content">
    <!-- Language Switcher -->
    <div class="mb-3 no-print text-start" id="lang-bar">
      <select id="lang-switcher" class="form-select w-auto"></select>
    </div>

    <!-- Header -->
    <div class="card mb-4 text-end">
      <div class="card-header bg-success text-white">
        <h2 class="mb-0" data-i18n="header">مخطط الوجبات وقائمة التسوق</h2>
      </div>
    </div>
    <div class="seo-paragraph">
  <p>
    <strong>مخطط وجبات أسبوعي عبر الإنترنت</strong> – أنشئ خطة وجباتك للأسبوع بالكامل، ووفر الوقت والمال، واستمتع بوجبات صحية مع عائلتك. تطبيقنا المجاني يتيح لك تسجيل وجباتك اليومية، وإنشاء قائمة تسوق تلقائياً، وتحميل كل ذلك بصيغة PDF.
  </p>
  <p>
    سواء كنت ترغب في تنظيم وجبات الأطفال، أو اتباع نظام غذائي متوازن، أو فقط ترغب في إدارة ميزانيتك بشكل أفضل، هذا المخطط يساعدك على الالتزام بالخطة وتجنب هدر الطعام. كل شيء سريع وسهل الاستخدام عبر الإنترنت، ويمكنك استخدام التطبيق بأي لغة تريدها!
  </p>
  <p>
    جرب مخطط الوجبات الأسبوعي المجاني – بسيط، مفيد، ولا حاجة لحساب!
  </p>
</div>

    <!-- Planner Table -->
    <div class="card mb-4">
      <div class="card-body text-end">
        <table class="table mb-0">
          <thead>
            <tr>
              <th data-i18n="col.day">اليوم</th>
              <th data-i18n="col.lunch">الغداء (المكونات)</th>
              <th data-i18n="col.dinner">العشاء (المكونات)</th>
            </tr>
          </thead>
          <tbody id="plan-table"></tbody>
        </table>
      </div>
    </div>

    <!-- MESAJ IMPACT ȘI LISTA PENTRU PDF - ascunse by default -->
<div id="pdf-impact-area" style="display: none; text-align:center; margin-bottom:30px;">
  <h2 id="pdf-impact-message" style="color: #198754; font-size: 2rem;">
    اعتنِ بصحتك وصحة عائلتك! اطبخ بحب واستمتع بكل وجبة!
  </h2>
  <div id="pdf-list" style="margin-top:30px;"></div>
</div>

    <!-- Shopping List -->
    <div class="card mb-4">
      <div class="card-body text-end">
        <h5 data-i18n="shoppingList">قائمة التسوق</h5>
        <ul id="shopping-list" class="list-group list-group-flush"></ul>
      </div>
    </div>

    <!-- Buttons -->
    <div class="text-center mb-4 no-print btn-bar">
      <button id="generate-btn" class="btn btn-success me-2" type="button">
        <i class="bi bi-file-earmark-pdf-fill"></i>
        <span data-i18n="btn.generate">إنشاء PDF</span>
      </button>
      <a id="pay-btn"
         href="https://buy.stripe.com/00w6oHeDjcPEasLcbY3Ru07"
         target="_blank"
         class="btn btn-warning">
        <i class="bi bi-cart-check-fill"></i>
        <span data-i18n="btn.pay">ادفع وحمّل</span>
      </a>
      <div id="payment-status" class="mt-2"></div>
    </div>

    <!-- Email verification for PDF unlimited access -->
    <div class="card mb-4 text-center" id="access-card">
      <div class="card-header bg-primary text-white">
        <span data-i18n="unlock">هل دفعت بالفعل؟ فعّل التنزيلات غير المحدودة للـ PDF</span>
      </div>
      <div class="card-body">
        <input type="email" id="emailInput" class="form-control mb-2" placeholder="أدخل بريد الدفع الخاص بك">
        <button id="verifyBtn" class="btn btn-success"><span data-i18n="btn.verify">تأكيد البريد</span></button>
        <div id="result" class="mt-3"></div>
      </div>
    </div>
  </div>

  <!-- App Logic -->
  <script src="/js/app.js"></script>

  <!-- Supabase Email Verification Script -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const supabase = window.supabase.createClient(
      'https://hwbzbidorkwtyvirozho.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh3YnpiaWRvcmt3dHl2aXJvemhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4OTE0ODUsImV4cCI6MjA2NzQ2NzQ4NX0.4bjszL8tRw0tcnWu8BN-Et8eWyerJFNj6U9tGraEwEA'
    );

    document.getElementById('verifyBtn').onclick = async function() {
      const email = document.getElementById('emailInput').value.trim();
      const resultDiv = document.getElementById('result');
      resultDiv.innerText = '...جاري التحقق';

      if (!email) {
        resultDiv.innerHTML = `<span class="text-danger">يرجى إدخال بريد الدفع!</span>`;
        return;
      }

      // Selectează TOATE tokenurile pentru emailul dat
      const { data, error } = await supabase
        .from('tokens')
        .select('*')
        .eq('email', email);

      if (error) {
        resultDiv.innerHTML = `<span class="text-danger">خطأ في الخادم. حاول مرة أخرى.</span>`;
        return;
      }

      // Verifică dacă există vreun token valid (ne-expirat)
      if (data && data.length > 0) {
        const now = Date.now();
        const valid = data.some(token => !token.expires_at || token.expires_at > now);

        if (valid) {
          resultDiv.innerHTML = `
            <span class="text-success mb-2 d-block">✅ لديك وصول! يمكنك تنزيل الـ PDF بشكل غير محدود:</span>
            <button id="paid-generate-pdf" class="btn btn-primary">تحميل PDF</button>
          `;
          document.getElementById('pay-btn').style.display = 'none';

          setTimeout(() => {
            const generateBtn = document.getElementById('generate-btn');
            const paidBtn = document.getElementById('paid-generate-pdf');
            if (paidBtn && generateBtn) {
              paidBtn.addEventListener('click', function() {
                generateBtn.click();
              });
            }
          }, 0);

        } else {
          resultDiv.innerHTML = `<span class="text-danger">لا يوجد وصول صالح لهذا البريد.</span>`;
        }
      } else {
        resultDiv.innerHTML = `<span class="text-danger">لا يوجد وصول لهذا البريد. ادفع أولاً أو تحقق من البريد.</span>`;
      }
    }
  </script>
</body>
</html>
