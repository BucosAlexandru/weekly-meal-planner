(()=>{async function a({customerId:r,email:t}){try{let e=await fetch("/api/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerId:r||null,email:t||null,return_url:window.location.origin+"/account"})}),o=await e.json();if(!e.ok)throw new Error(o?.error||"Portal session failed");o?.url?window.location.href=o.url:alert("Nu am putut deschide portalul.")}catch(e){console.error("Portal error:",e),alert(e.message||"Eroare la deschiderea portalului.")}}document.addEventListener("click",r=>{if(r.target&&r.target.id==="manage-subscription"){let t=window.currentUserEmail||document.querySelector("#emailInput")?.value?.trim()||null;a({email:t,customerId:window.currentStripeCustomerId||null})}});})();
