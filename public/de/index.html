<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="title">Wöchentlicher Essensplaner – Einkaufsliste & PDF kostenlos</title>
  <meta name="description" content="Wöchentlicher Essensplaner auf Deutsch. Erstelle deinen Wochenplan und lade die Einkaufsliste als PDF herunter – kostenlos, direkt im Browser." />
  <meta name="keywords" content="Essensplaner, Einkaufslisten, Wochenplaner, Menüplaner, Mahlzeitenplan, Familienmenü, Mahlzeitenplan kostenlos, Mahlzeitenplan PDF, meal planner deutsch" />
  <link rel="canonical" href="https://meal-planner.ro/de/" />

  <!-- hreflang -->
  <link rel="alternate" hreflang="x-default" href="https://meal-planner.ro/" />
  <link rel="alternate" hreflang="ro" href="https://meal-planner.ro/ro/" />
  <link rel="alternate" hreflang="en" href="https://meal-planner.ro/en/" />
  <link rel="alternate" hreflang="es" href="https://meal-planner.ro/es/" />
  <link rel="alternate" hreflang="fr" href="https://meal-planner.ro/fr/" />
  <link rel="alternate" hreflang="ru" href="https://meal-planner.ro/ru/" />
  <link rel="alternate" hreflang="zh" href="https://meal-planner.ro/zh/" />
  <link rel="alternate" hreflang="ja" href="https://meal-planner.ro/ja/" />
  <link rel="alternate" hreflang="pt" href="https://meal-planner.ro/pt/" />
  <link rel="alternate" hreflang="de" href="https://meal-planner.ro/de/" />
  <link rel="alternate" hreflang="ar" href="https://meal-planner.ro/ar/" />
  <link rel="alternate" hreflang="hi" href="https://meal-planner.ro/hi/" />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="Wöchentlicher Essensplaner" />
  <meta property="og:description" content="Erstelle deinen Wochenplan und lade die Einkaufsliste als PDF herunter, kostenlos, auf Deutsch." />
  <meta property="og:url" content="https://meal-planner.ro/de/" />
  <meta property="og:image" content="https://meal-planner.ro/cover.jpg" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Wöchentlicher Essensplaner" />
  <meta name="twitter:description" content="Schnell Essensplan erstellen & PDF kostenlos herunterladen." />
  <meta name="twitter:url" content="https://meal-planner.ro/de/" />

  <!-- Favicons all platforms -->
  <link rel="icon" type="image/png" href="/images/MP-favicon.png" />
  <link rel="apple-touch-icon" href="/images/MP-favicon.png">
  <meta name="msapplication-TileImage" content="/images/MP-favicon.png">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
  <link rel="stylesheet" href="/css/style.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
</head>
<body>
  <div class="container py-5" id="pdf-content">
    <!-- Language Switcher -->
    <div class="mb-3 no-print text-end" id="lang-bar">
      <select id="lang-switcher" class="form-select w-auto"></select>
    </div>

    <!-- Header -->
    <div class="card mb-4 text-center">
      <div class="card-header bg-success text-white">
        <h2 class="mb-0" data-i18n="header">Essensplaner & Einkaufsliste</h2>
      </div>
    </div>
    <div class="seo-paragraph" id="seo-paragraph">
      <p>
        <strong>Wöchentlicher Essensplaner online</strong> – Erstelle deinen Menüplan für die ganze Woche, spare Zeit und Geld und genieße gesunde Mahlzeiten mit der Familie. Unsere kostenlose App hilft dir dabei, deine täglichen Gerichte festzuhalten, automatisch eine Einkaufsliste zu generieren und alles als PDF herunterzuladen.
      </p>
      <p>
        Egal ob du die Mahlzeiten für Kinder organisieren möchtest, einer ausgewogenen Ernährung folgen willst oder einfach effizienter mit deinem Budget umgehen möchtest – dieser Planer hilft dir, am Plan zu bleiben und Lebensmittelverschwendung zu vermeiden. Alles ist schnell, online und du kannst die App in jeder gewünschten Sprache nutzen!
      </p>
      <p>
        Probiere den kostenlosen wöchentlichen Essensplaner aus – einfach, praktisch und ohne Anmeldung!
      </p>
    </div>

    <!-- Planner Table -->
    <div class="card mb-4">
      <div class="card-body">
        <table class="table mb-0">
          <thead>
            <tr>
              <th data-i18n="col.day">Tag</th>
              <th data-i18n="col.lunch">Mittagessen (Zutaten)</th>
              <th data-i18n="col.dinner">Abendessen (Zutaten)</th>
            </tr>
          </thead>
          <tbody id="plan-table"></tbody>
        </table>
      </div>
    </div>
    <!-- MESAJ IMPACT UND LISTE FÜR PDF - standardmäßig versteckt -->
    <div id="pdf-impact-area" style="display: none; text-align:center; margin-bottom:30px;">
      <h2 id="pdf-impact-message" style="color: #198754; font-size: 2rem;">
        Achte auf deine Gesundheit und die deiner Familie. Koche mit Freude und genieße jede Mahlzeit!
      </h2>
      <div id="pdf-list" style="margin-top:30px;"></div>
    </div>

    <!-- Shopping List -->
    <div class="card mb-4">
      <div class="card-body">
        <h5 data-i18n="shoppingList">Einkaufsliste</h5>
        <ul id="shopping-list" class="list-group list-group-flush"></ul>
      </div>
    </div>

    <!-- Buttons -->
    <div class="text-center mb-4 no-print btn-bar">
      <button id="generate-btn" class="btn btn-success me-2" type="button">
        <i class="bi bi-file-earmark-pdf-fill"></i>
        <span data-i18n="btn.generate">PDF erstellen</span>
      </button>
      <a href="https://buy.stripe.com/00w6oHeDjcPEasLcbY3Ru07"
         target="_blank"
         class="btn btn-warning"
         id="pay-btn">
        <i class="bi bi-cart-check-fill"></i>
        <span data-i18n="btn.pay">Bezahlen & Herunterladen</span>
      </a>
      <div id="payment-status" class="mt-2"></div>
    </div>

    <!-- Email verification for PDF unlimited access -->
    <div class="card mb-4 text-center" id="access-card">
  <div class="card-header bg-primary text-white">
    <span data-i18n="banner.unlock">Already paid? Unlock unlimited PDF downloads</span>
  </div>
  <div class="card-body">
    <input type="email" id="emailInput" class="form-control mb-2" data-i18n-placeholder="input.email">
    <button id="verifyBtn" class="btn btn-success" data-i18n="btn.verify">Verify Email</button>
    <div id="result" class="mt-3"></div>
  </div>
</div>


  <!-- App Logic -->
  <script src="/js/app.js"></script>

  <!-- Supabase Email Verification Script -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const supabase = window.supabase.createClient(
      'https://hwbzbidorkwtyvirozho.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh3YnpiaWRvcmt3dHl2aXJvemhvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4OTE0ODUsImV4cCI6MjA2NzQ2NzQ4NX0.4bjszL8tRw0tcnWu8BN-Et8eWyerJFNj6U9tGraEwEA'
    );

    document.getElementById('verifyBtn').onclick = async function() {
      const email = document.getElementById('emailInput').value.trim();
      const resultDiv = document.getElementById('result');
      resultDiv.innerText = 'Prüfung läuft...';

      if (!email) {
        resultDiv.innerHTML = `<span class="text-danger">Bitte E-Mail eingeben!</span>`;
        return;
      }

      // Alle Token für diese E-Mail abrufen
      const { data, error } = await supabase
        .from('tokens')
        .select('*')
        .eq('email', email);

      if (error) {
        resultDiv.innerHTML = `<span class="text-danger">Serverfehler. Bitte erneut versuchen.</span>`;
        return;
      }

      if (data && data.length > 0) {
        const now = Date.now();
        const valid = data.some(token => !token.expires_at || token.expires_at > now);

        if (valid) {
          resultDiv.innerHTML = `
            <span class="text-success mb-2 d-block">✅ Zugriff freigeschaltet! Du kannst das PDF unbegrenzt herunterladen:</span>
            <button id="paid-generate-pdf" class="btn btn-primary">PDF herunterladen</button>
          `;
          document.getElementById('pay-btn').style.display = 'none';

          setTimeout(() => {
            const generateBtn = document.getElementById('generate-btn');
            const paidBtn = document.getElementById('paid-generate-pdf');
            if (paidBtn && generateBtn) {
              paidBtn.addEventListener('click', function() {
                generateBtn.click();
              });
            }
          }, 0);

        } else {
          resultDiv.innerHTML = `<span class="text-danger">Kein gültiger Zugang für diese E-Mail.</span>`;
        }
      } else {
        resultDiv.innerHTML = `<span class="text-danger">Kein Zugang für diese E-Mail. Bitte bezahle zuerst oder prüfe die Adresse.</span>`;
      }
    }
    document.getElementById('emailInput').addEventListener('keydown', function(e) {
  if (e.key === 'Enter') {
    e.preventDefault();
    document.getElementById('verifyBtn').click();
  }
});
  </script>
</body>
</html>
